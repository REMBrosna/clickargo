{"ast":null,"code":"import _toConsumableArray from \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\src\\\\app\\\\views\\\\applications\\\\messagePopUp\\\\UserPopUpMessage.jsx\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport SockJS from \"sockjs-client\";\nimport { Client } from \"@stomp/stompjs\";\nvar UserPopUpMessage = function UserPopUpMessage() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    messages = _useState2[0],\n    setMessages = _useState2[1];\n  var stompClientRef = useRef(null);\n  var _useState3 = useState(\"\"),\n    _useState4 = _slicedToArray(_useState3, 2),\n    input = _useState4[0],\n    setInput = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isConnected = _useState6[0],\n    setIsConnected = _useState6[1];\n  console.log(\"isConnected\", isConnected);\n  useEffect(function () {\n    var socket = new SockJS(\"http://localhost:8080/ws\");\n    var client = new Client({\n      webSocketFactory: function webSocketFactory() {\n        return socket;\n      },\n      reconnectDelay: 5000,\n      onConnect: function onConnect() {\n        console.log(\"Connected!\");\n        setIsConnected(true);\n        client.subscribe(\"/topic/public\", function (message) {\n          var msgBody = JSON.parse(message.body);\n          setMessages(function (prev) {\n            return [].concat(_toConsumableArray(prev), [msgBody.content]);\n          });\n        });\n      },\n      onStompError: function onStompError(frame) {\n        console.error(\"Broker error:\", frame.headers[\"message\"]);\n        console.error(\"Details:\", frame.body);\n      }\n    });\n    client.activate();\n    stompClientRef.current = client;\n    return function () {\n      client.deactivate();\n    };\n  }, []);\n  var sendMessage = function sendMessage() {\n    var client = stompClientRef.current;\n    if (client && client.connected && input.trim()) {\n      var chatMessage = {\n        sender: \"User\",\n        content: input,\n        type: \"CHAT\"\n      };\n      client.publish({\n        destination: \"/app/chat.sendMessage\",\n        body: JSON.stringify(chatMessage)\n      });\n      setInput(\"\");\n    } else {\n      console.warn(\"STOMP client is not connected yet!\");\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: 20\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }, \"WebSocket Chat\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      border: \"1px solid gray\",\n      padding: 10,\n      height: 200,\n      overflowY: \"scroll\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }, messages.map(function (msg, index) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 21\n      }\n    }, msg);\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    value: input,\n    onChange: function onChange(e) {\n      return setInput(e.target.value);\n    },\n    onKeyDown: function onKeyDown(e) {\n      return e.key === \"Enter\" && sendMessage();\n    },\n    placeholder: \"Type message...\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }, \"Send\"));\n};\nexport default UserPopUpMessage;","map":{"version":3,"names":["React","useEffect","useState","useRef","SockJS","Client","UserPopUpMessage","messages","setMessages","stompClientRef","input","setInput","isConnected","setIsConnected","console","log","socket","client","webSocketFactory","reconnectDelay","onConnect","subscribe","message","msgBody","JSON","parse","body","prev","content","onStompError","frame","error","headers","activate","current","deactivate","sendMessage","connected","trim","chatMessage","sender","type","publish","destination","stringify","warn","padding","border","height","overflowY","map","msg","index","e","target","value","key"],"sources":["D:/Collap Projects/ACLEDA-Student/student-ui/src/app/views/applications/messagePopUp/UserPopUpMessage.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport SockJS from \"sockjs-client\";\r\nimport { Client } from \"@stomp/stompjs\";\r\nconst UserPopUpMessage = () => {\r\n    const [messages, setMessages] = useState([]);\r\n    const stompClientRef = useRef(null);\r\n    const [input, setInput] = useState(\"\");\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    console.log(\"isConnected\", isConnected)\r\n    useEffect(() => {\r\n        const socket = new SockJS(\"http://localhost:8080/ws\");\r\n        const client = new Client({\r\n            webSocketFactory: () => socket,\r\n            reconnectDelay: 5000,\r\n            onConnect: () => {\r\n                console.log(\"Connected!\");\r\n                setIsConnected(true);\r\n\r\n                client.subscribe(\"/topic/public\", (message) => {\r\n                    const msgBody = JSON.parse(message.body);\r\n                    setMessages((prev) => [...prev, msgBody.content]);\r\n                });\r\n            },\r\n            onStompError: (frame) => {\r\n                console.error(\"Broker error:\", frame.headers[\"message\"]);\r\n                console.error(\"Details:\", frame.body);\r\n            },\r\n        });\r\n\r\n        client.activate();\r\n        stompClientRef.current = client;\r\n\r\n        return () => {\r\n            client.deactivate();\r\n        };\r\n    }, []);\r\n\r\n\r\n    const sendMessage = () => {\r\n        const client = stompClientRef.current;\r\n\r\n        if (client && client.connected && input.trim()) {\r\n            const chatMessage = {\r\n                sender: \"User\",\r\n                content: input,\r\n                type: \"CHAT\",\r\n            };\r\n\r\n            client.publish({\r\n                destination: \"/app/chat.sendMessage\",\r\n                body: JSON.stringify(chatMessage),\r\n            });\r\n\r\n            setInput(\"\");\r\n        } else {\r\n            console.warn(\"STOMP client is not connected yet!\");\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <div style={{ padding: 20 }}>\r\n            <h2>WebSocket Chat</h2>\r\n            <div style={{ border: \"1px solid gray\", padding: 10, height: 200, overflowY: \"scroll\" }}>\r\n                {messages.map((msg, index) => (\r\n                    <div key={index}>{msg}</div>\r\n                ))}\r\n            </div>\r\n            <input\r\n                value={input}\r\n                onChange={(e) => setInput(e.target.value)}\r\n                onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n                placeholder=\"Type message...\"\r\n            />\r\n            <button onClick={sendMessage}>Send</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UserPopUpMessage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}