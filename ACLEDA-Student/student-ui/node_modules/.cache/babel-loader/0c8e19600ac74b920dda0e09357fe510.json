{"ast":null,"code":"import _toConsumableArray from \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"D:\\\\Collap Projects\\\\ACLEDA-Student\\\\student-ui\\\\src\\\\app\\\\views\\\\applications\\\\messagePopUp\\\\UserPopUpMessage.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport SockJS from \"sockjs-client\";\nimport { Client } from \"@stomp/stompjs\";\nimport axios from \"axios\";\nvar Chat = function Chat() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    client = _useState2[0],\n    setClient = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    messages = _useState4[0],\n    setMessages = _useState4[1];\n  var _useState5 = useState(\"\"),\n    _useState6 = _slicedToArray(_useState5, 2),\n    content = _useState6[0],\n    setContent = _useState6[1];\n  var sender = \"User\" + Math.floor(Math.random() * 1000);\n  useEffect(function () {\n    // Fetch stored messages from DB\n    axios.get(\"http://localhost:8080/\").then(function (res) {\n      setMessages(res.data);\n    });\n\n    // Connect WebSocket\n    var sock = new SockJS(\"http://localhost:8080/ws\");\n    var stompClient = new Client({\n      webSocketFactory: function webSocketFactory() {\n        return sock;\n      },\n      onConnect: function onConnect() {\n        stompClient.subscribe(\"/topic/public\", function (message) {\n          var msg = JSON.parse(message.body);\n          setMessages(function (prev) {\n            return [].concat(_toConsumableArray(prev), [msg]);\n          });\n        });\n\n        // Optional: notify new user joined\n        stompClient.publish({\n          destination: \"/app/chat.addUser\",\n          body: JSON.stringify({\n            sender: sender\n          })\n        });\n      }\n    });\n    stompClient.activate();\n    setClient(stompClient);\n    return function () {\n      return stompClient.deactivate();\n    };\n  }, []);\n  var sendMessage = function sendMessage() {\n    if (content && (client === null || client === void 0 ? void 0 : client.connected)) {\n      var msg = {\n        sender: sender,\n        content: content\n      };\n      client.publish({\n        destination: \"/app/chat.sendMessage\",\n        body: JSON.stringify(msg)\n      });\n      setContent(\"\");\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: \"1rem\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, \"WebSocket Chat\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: 300,\n      overflowY: \"scroll\",\n      border: \"1px solid #ccc\",\n      padding: 10,\n      marginBottom: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }\n  }, messages.map(function (msg, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"b\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 25\n      }\n    }, msg.sender), \": \", msg.content);\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    value: content,\n    onChange: function onChange(e) {\n      return setContent(e.target.value);\n    },\n    onKeyDown: function onKeyDown(e) {\n      return e.key === \"Enter\" && sendMessage();\n    },\n    placeholder: \"Type a message\",\n    style: {\n      width: \"80%\",\n      marginRight: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }, \"Send\"));\n};\nexport default Chat;","map":{"version":3,"names":["React","useEffect","useState","SockJS","Client","axios","Chat","client","setClient","messages","setMessages","content","setContent","sender","Math","floor","random","get","then","res","data","sock","stompClient","webSocketFactory","onConnect","subscribe","message","msg","JSON","parse","body","prev","publish","destination","stringify","activate","deactivate","sendMessage","connected","padding","height","overflowY","border","marginBottom","map","i","e","target","value","key","width","marginRight"],"sources":["D:/Collap Projects/ACLEDA-Student/student-ui/src/app/views/applications/messagePopUp/UserPopUpMessage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport SockJS from \"sockjs-client\";\r\nimport { Client } from \"@stomp/stompjs\";\r\nimport axios from \"axios\";\r\n\r\nconst Chat = () => {\r\n    const [client, setClient] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [content, setContent] = useState(\"\");\r\n    const sender = \"User\" + Math.floor(Math.random() * 1000);\r\n\r\n    useEffect(() => {\r\n        // Fetch stored messages from DB\r\n        axios.get(\"http://localhost:8080/\").then((res) => {\r\n            setMessages(res.data);\r\n        });\r\n\r\n        // Connect WebSocket\r\n        const sock = new SockJS(\"http://localhost:8080/ws\");\r\n        const stompClient = new Client({\r\n            webSocketFactory: () => sock,\r\n            onConnect: () => {\r\n                stompClient.subscribe(\"/topic/public\", (message) => {\r\n                    const msg = JSON.parse(message.body);\r\n                    setMessages((prev) => [...prev, msg]);\r\n                });\r\n\r\n                // Optional: notify new user joined\r\n                stompClient.publish({\r\n                    destination: \"/app/chat.addUser\",\r\n                    body: JSON.stringify({ sender }),\r\n                });\r\n            },\r\n        });\r\n\r\n        stompClient.activate();\r\n        setClient(stompClient);\r\n\r\n        return () => stompClient.deactivate();\r\n    }, []);\r\n\r\n    const sendMessage = () => {\r\n        if (content && client?.connected) {\r\n            const msg = {\r\n                sender,\r\n                content,\r\n            };\r\n            client.publish({\r\n                destination: \"/app/chat.sendMessage\",\r\n                body: JSON.stringify(msg),\r\n            });\r\n            setContent(\"\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: \"1rem\" }}>\r\n            <h2>WebSocket Chat</h2>\r\n            <div\r\n                style={{\r\n                    height: 300,\r\n                    overflowY: \"scroll\",\r\n                    border: \"1px solid #ccc\",\r\n                    padding: 10,\r\n                    marginBottom: 10,\r\n                }}\r\n            >\r\n                {messages.map((msg, i) => (\r\n                    <div key={i}>\r\n                        <b>{msg.sender}</b>: {msg.content}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            <input\r\n                value={content}\r\n                onChange={(e) => setContent(e.target.value)}\r\n                onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n                placeholder=\"Type a message\"\r\n                style={{ width: \"80%\", marginRight: 10 }}\r\n            />\r\n            <button onClick={sendMessage}>Send</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Chat;\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}